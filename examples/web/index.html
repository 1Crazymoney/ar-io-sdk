<html>
  <head>
    <!-- import permanent tailwind -->
    <script src="https://arweave.net/RjXXBjP2GCZZUg4gSW1Hyr9GtLG-o59QCHrKiITtpQw"></script>
    <script>
      tailwind.config = {
        theme: {
          borderWidth: {
            1: '1px',
          },
          extend: {
            colors: {
              primary: '#FFBB38',
              background: '#141416',
              surface: '#222224',
              surfaceSecondary: '#2E2E30',
              textPrimary: '#F5F5F5',
              textSubtle: '#7A7A7C',
            },
          },
        },
      };
    </script>
  </head>
  <body class="bg-background flex flex-col items-center p-10">
    <div
      class="bg-surface flex flex-col gap-5 items-end justify-center p-5 rounded-md h-full"
      style="width: 750px"
    >
      <div class="h-full w-full" style="overflow-y: scroll">
        <table class="w-full bg-background text-textPrimary">
          <thead>
            <tr>
              <th class="px-4 py-2">Domain</th>
              <th class="px-4 py-2">Owner</th>
              <th class="px-4 py-2">Stake</th>
            </tr>
          </thead>
          <tbody id="table-body">
            <!-- Add more rows as needed -->
          </tbody>
        </table>
      </div>
      <button
        id="fetch-gateways-button"
        class="animate-bounce bg-primary text-textPrimary p-2 rounded-md w-full text-surface hover:shadow-xl"
        style="color: black"
      >
        Fetch Gateways
      </button>
    </div>
    <script type="module">
      import { ArIO } from './web.bundle.min.js';

      // set up our client
      const arIO = new ArIO({}).testnet;

      async function setGateways() {
        const tableBody = document.getElementById('table-body');
        tableBody.innerHTML = `
              <tr>
                <td class="border border-surface px-4 py-2">Loading...</td>
              </tr>
            `;
        const gateways = await arIO.getGateways();

        tableBody.innerHTML = Object.entries(gateways)
          .map(([gatewayOwner, gateway]) => {
            return `
              <tr>
                <td class="border border-surface px-4 py-2 text-primary"><a href="https://${gateway.settings.fqdn}" target="_blank">${gateway.settings.fqdn}</a></td>
                <td class="border border-surface px-4 py-2 text-primary"><a href="https://arscan.io/address/${gatewayOwner}" target="_blank">${gatewayOwner}</a></td>
                <td class="border border-surface px-4 py-2">${gateway.operatorStake} IO</td>
              </tr>
            `;
          })
          .join('');
      }

      const fetchGatewaysButton = document.getElementById(
        'fetch-gateways-button',
      );
      fetchGatewaysButton.addEventListener('click', () => {
        setGateways();
      });
    </script>
  </body>
</html>
